{"version":3,"file":"printButton.js","sourceRoot":"","sources":["../../../../../sourceES6/viewer/src/templating/plugins/printButton.ts"],"names":[],"mappings":";;;;;;;;;;;;;AAAA,OAAO,EAAE,0BAA0B,EAAE,MAAM,yBAAyB,CAAC;AAGrE,OAAO,EAAE,KAAK,EAAE,MAAM,4BAA4B,CAAC;AAEnD;IAAuC,qCAA0B;IAI7D,2BAAoB,OAAsB;QAA1C,YACI,kBAAM,OAAO,EAAE,cAAc,EAAE,iBAAiB,CAAC,YAAY,CAAC,SAsBjE;QAvBmB,aAAO,GAAP,OAAO,CAAe;QAGtC,KAAI,CAAC,OAAO,CAAC,uBAAuB,CAAC,GAAG,CAAC,UAAC,KAAK;YAC3C,KAAI,CAAC,gBAAgB,GAAG,EAAE,CAAC;YAC3B,IAAI,KAAK,CAAC,aAAa,CAAC,GAAG,EAAE;gBACzB,IAAI,QAAQ,GAAG,KAAK,CAAC,WAAW,CAAC,KAAK,CAAC,aAAa,CAAC,GAAG,CAAC,IAAI,KAAK,CAAC,aAAa,CAAC,GAAG,CAAC;gBACrF,IAAI,OAAO,GAAG,KAAK,CAAC,aAAa,CAAC,IAAI,IAAI,KAAK,CAAC,aAAa,CAAC,KAAK,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC;gBAEvF,gBAAgB;gBAChB,IAAI,WAAS,GAAG,KAAK,CAAC,aAAa,CAAC,MAAM,IAAI,QAAQ,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,GAAG,EAAE,IAAI,EAAE,CAAC;gBAC9E,IAAI,WAAS,GAAG,KAAK,CAAC;gBACtB,8BAA8B;gBAC9B,CAAC,MAAM,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,CAAC,CAAC,OAAO,CAAC,UAAC,GAAG;oBACtC,IAAI,WAAS,CAAC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,EAAE;wBAC/B,WAAS,GAAG,IAAI,CAAC;qBACpB;gBACL,CAAC,CAAC,CAAC;gBACH,IAAI,WAAS,EAAE;oBACX,KAAI,CAAC,gBAAgB,GAAG,OAAO,GAAG,QAAQ,CAAC;iBAC9C;aACJ;QACL,CAAC,CAAC,CAAC;;IACP,CAAC;IAED,mCAAO,GAAP,UAAQ,KAAoB;QACxB,IAAI,IAAI,CAAC,gBAAgB,EAAE;YACvB,IAAI,QAAQ,GAAG,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,aAAa,EAAE,4BAA4B,CAAC,CAAC;YAC1F,MAAM,CAAC,IAAI,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC;SAClC;IACL,CAAC;IAEgB,8BAAY,GAAW,6PAed,MAAM,CAAC,SAAS,CAAC,SAAS,CAAC,OAAO,CAAC,iBAAiB,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC,CAAC,EAAE,kHAI5G,CAAC;IACF,wBAAC;CAAA,AAxDD,CAAuC,0BAA0B,GAwDhE;SAxDY,iBAAiB","sourcesContent":["import { AbstractViewerNavbarButton } from \"../viewerTemplatePlugin\";\r\nimport { DefaultViewer } from \"../../viewer/defaultViewer\";\r\nimport { EventCallback } from \"../templateManager\";\r\nimport { Tools } from \"@babylonjs/core/Misc/tools\";\r\n\r\nexport class PrintButtonPlugin extends AbstractViewerNavbarButton {\r\n\r\n    private _currentModelUrl: string;\r\n\r\n    constructor(private _viewer: DefaultViewer) {\r\n        super(\"print\", \"print-button\", PrintButtonPlugin.HtmlTemplate);\r\n\r\n        this._viewer.onModelLoadedObservable.add((model) => {\r\n            this._currentModelUrl = \"\";\r\n            if (model.configuration.url) {\r\n                let filename = Tools.GetFilename(model.configuration.url) || model.configuration.url;\r\n                let baseUrl = model.configuration.root || Tools.GetFolderPath(model.configuration.url);\r\n\r\n                //gltf, obj, stl\r\n                let extension = model.configuration.loader || filename.split(\".\").pop() || \"\";\r\n                let printable = false;\r\n                // not using .some sue to IE11\r\n                [\"gltf\", \"glb\", \"obj\", \"stl\"].forEach((ext) => {\r\n                    if (extension.indexOf(ext) !== -1) {\r\n                        printable = true;\r\n                    }\r\n                });\r\n                if (printable) {\r\n                    this._currentModelUrl = baseUrl + filename;\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    onEvent(event: EventCallback): void {\r\n        if (this._currentModelUrl) {\r\n            let printUrl = this._currentModelUrl.replace(/https?:\\/\\//, \"com.microsoft.builder3d://\");\r\n            window.open(printUrl, \"_self\");\r\n        }\r\n    }\r\n\r\n    protected static HtmlTemplate: string = `\r\n{{#unless hidePrint}}\r\n<style>\r\n\r\n/* Show only if it's a windows 10 printer  */\r\n.print-icon.not-win-10 {\r\n    display: none;\r\n}\r\n\r\n.print-icon:after {\r\n    font-size: 16px;\r\n    content: \"\\\\E914\";\r\n}\r\n\r\n</style>\r\n<button class=\"print-button ${window.navigator.userAgent.indexOf(\"Windows NT 10.0\") === -1 ? \"no-win-10\" : \"\"}\" title=\"{{text.printButton}}\">\r\n     <span class=\"icon print-icon\"></span>\r\n </button>\r\n {{/unless}}\r\n`;\r\n}\r\n"]}